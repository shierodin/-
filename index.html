<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Python Game Console</title>
    <style>
        body { background-color: #0c0c0c; color: #00ff41; font-family: 'Consolas', 'Courier New', monospace; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        #console { width: 90%; max-width: 700px; height: 500px; border: 1px solid #00ff41; padding: 15px; overflow-y: auto; background: #000; white-space: pre-wrap; margin-bottom: 10px; box-shadow: 0 0 15px rgba(0, 255, 65, 0.2); }
        #input-container { width: 90%; max-width: 700px; display: flex; gap: 10px; }
        input { flex: 1; background: #000; border: 1px solid #00ff41; color: #00ff41; padding: 10px; font-size: 16px; outline: none; }
        button { background: #00ff41; color: #000; border: none; padding: 10px 20px; font-weight: bold; cursor: pointer; }
        button:hover { background: #008f11; }
    </style>
</head>
<body>

<div id="console"></div>
<div id="input-container">
    <input type="text" id="user-input" placeholder="명령어 입력..." autofocus>
    <button onclick="processInput()">입력</button>
</div>

<script>
    // --- 파이썬 변수 그대로 선언 ---
    let mm = 1000;
    let se = 1;
    let dd = 1;
    let q = 0, w = 0, e = 0;
    let xc = 0, cc = 0;
    
    // 현재 게임의 메뉴 상태 관리
    let currentMenu = "MAIN"; 
    let subMenu = ""; // 고용(1,2,3), 도박(도박,주식) 등 세부 단계

    const consoleBox = document.getElementById('console');
    const inputField = document.getElementById('user-input');

    function print(text = "") {
        consoleBox.innerText += text + "\n";
        consoleBox.scrollTop = consoleBox.scrollHeight;
    }

    // --- 쓰레드(자동 돈 벌기) 구현 ---
    function startThread1() { setInterval(() => { mm += se * 500; }, 5000); }
    function startThread2() { setInterval(() => { mm += se * 6500; }, 3000); }
    function startThread3() { setInterval(() => { mm += se * 9000; }, 2000); }

    function showMainMenu() {
        print(`\n고용 | 업그레이드 | ${Math.floor(mm)}원/10,000,000원 | 돈벌기 | 도박`);
        if (mm >= 10000000) print("-the end-");
    }

    function processInput() {
        const n = inputField.value.trim();
        if (n !== "") print(`> ${n}`); // 입력값 표시
        inputField.value = "";

        // 1. 메인 메뉴 로직
        if (currentMenu === "MAIN") {
            if (n.includes('고용')) {
                print("1,2,3(선택)");
                currentMenu = "HIRE";
            } else if (n.includes('업그레이드')) {
                currentMenu = "UPGRADE";
                print(`돈 효율 2% 상승 | 비용 : ${dd * 500}`);
                print("(사기,나가기)");
            } else if (n.includes('돈벌기')) {
                currentMenu = "WORK";
                print(`돈 ${se * 500} 벌림`);
                print("(벌기, 나가기)");
            } else if (n.includes('도박')) {
                currentMenu = "GAMBLE";
                print("도박,주식,나가기");
            } else {
                showMainMenu();
            }
        }
        // 2. 고용 메뉴
        else if (currentMenu === "HIRE") {
            if (subMenu === "") {
                if (n === '1') { print("일반 알바생 | 5초당 500원 | 비용 : 6000원"); subMenu = "1"; print("(사기,나가기)"); }
                else if (n === '2') { print("고급 알바생 | 3초당 6500원 | 비용 : 20000원"); subMenu = "2"; print("(사기,나가기)"); }
                else if (n === '3') { print("직원 | 2초당 9000원 | 비용 : 100,000원"); subMenu = "3"; print("(사기,나가기)"); }
                else { currentMenu = "MAIN"; showMainMenu(); }
            } else {
                if (n.includes('사기')) {
                    if (subMenu === "1") {
                        if (mm < 4000) print("돈이 부족합니다");
                        else if (q === 1) print("이미 구매 됨");
                        else { print("구매 성공"); mm -= 6000; q++; startThread1(); }
                    } else if (subMenu === "2") {
                        if (mm < 12000) print("돈이 부족합니다");
                        else if (w === 1) print("이미 구매 됨"); // 파이썬 원본 e==1 버그는 아래 3번과 겹치므로 w로 수정 가능하나 원본 유지 시 e
                        else { print("구매 성공"); mm -= 20000; w++; startThread2(); }
                    } else if (subMenu === "3") {
                        if (mm < 100000) print("돈이 부족합니다");
                        else if (e === 1) print("이미 구매 됨");
                        else { print("구매 성공"); mm -= 100000; e++; startThread3(); }
                    }
                }
                subMenu = ""; currentMenu = "MAIN"; showMainMenu();
            }
        }
        // 3. 업그레이드
        else if (currentMenu === "UPGRADE") {
            if (n.includes('사기')) {
                if (mm < dd * 500) print("돈이 부족합니다");
                else { print("구매 성공"); mm -= dd * 500; se += 1.02; dd += 1; }
                print(`돈 효율 2% 상승 | 비용 : ${dd * 500}`);
                print("(사기,나가기)");
            } else { currentMenu = "MAIN"; showMainMenu(); }
        }
        // 4. 돈벌기
        else if (currentMenu === "WORK") {
            if (n.includes('벌기')) { subMenu = "CLICK"; print("돈(돈 생김), 나가기"); }
            else if (subMenu === "CLICK" && n.includes('돈')) {
                mm += se * 500;
                print(`돈 벌림 | 현재 돈:${Math.floor(mm)}`);
                print("돈(돈 생김), 나가기");
            } else { subMenu = ""; currentMenu = "MAIN"; showMainMenu(); }
        }
        // 5. 도박/주식
        else if (currentMenu === "GAMBLE") {
            if (n.includes('도박')) { subMenu = "BET"; print("돈 걸기,나가기"); }
            else if (n.includes('주식')) { subMenu = "STOCK"; handleStock(); }
            else { currentMenu = "MAIN"; showMainMenu(); }
        }
        else if (subMenu === "BET") {
            if (n.includes('돈 걸기')) { print("얼마?"); subMenu = "BET_AMOUNT"; }
            else { subMenu = ""; print("도박,주식,나가기"); }
        }
        else if (subMenu === "BET_AMOUNT") {
            let amt = parseInt(n);
            if (!isNaN(amt)) {
                if (Math.random() < 0.5) { print("성공"); mm += amt * 2; }
                else { print("실패"); mm -= amt; }
            }
            subMenu = "BET"; print("돈 걸기,나가기");
        }
        else if (subMenu === "STOCK") {
            if (n.includes('사기')) { print("몇주?"); subMenu = "STOCK_BUY"; }
            else if (n.includes('팔기')) { print("몇주?"); subMenu = "STOCK_SELL"; }
            else { subMenu = ""; print("도박,주식,나가기"); }
        }
        else if (subMenu === "STOCK_BUY") {
            let count = parseInt(n);
            if (mm < cc * count) print("돈이 부족합니다");
            else { print(`${count}주 체결 완료`); xc += count; mm -= cc * count; }
            subMenu = "STOCK"; handleStock();
        }
        else if (subMenu === "STOCK_SELL") {
            let count = parseInt(n);
            if (xc < count) print("주 부족");
            else { 
                // 원본의 mm >= cc * n 조건 로직 유지
                if (mm >= cc * count) { print("매도 완료"); xc -= count; mm += cc * count; } 
                else { print("돈 부족"); }
            }
            subMenu = "STOCK"; handleStock();
        }
    }

    function handleStock() {
        if (cc <= 0) cc += 2000;
        cc = Math.floor(Math.random() * 6001) - 3000; // -3000 ~ 3000
        print(`현재 주식 : ${cc}원 | ${xc}주 보유`);
        print("사기,팔기,나가기");
    }

    // 초기 실행
    print("게임을 시작합니다.");
    showMainMenu();
    
    // 엔터키 지원
    inputField.addEventListener("keypress", (e) => {
        if (e.key === "Enter") processInput();
    });
</script>

</body>
</html>
